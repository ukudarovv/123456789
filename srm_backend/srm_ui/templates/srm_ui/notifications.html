{% extends "srm_ui/base.html" %}

{% block title %}–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - AvtoMat SRM{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
    <form method="post" action="{% url 'srm_ui:mark_all_notifications_read' %}" class="d-inline">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary">–ü–æ–º–µ—Ç–∏—Ç—å –≤—Å–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ</button>
    </form>
</div>

{% if notifications %}
    <div class="list-group">
        {% for notification in notifications %}
        <div class="list-group-item notification-item {% if not notification.is_read %}list-group-item-warning{% endif %}">
            <div class="d-flex w-100 justify-content-between">
                <h6 class="mb-1">
                    {% if notification.notification_type == "NEW_LEAD" %}
                        üÜï –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞
                    {% elif notification.notification_type == "STATUS_CHANGED" %}
                        üîÑ –ò–∑–º–µ–Ω–µ–Ω —Å—Ç–∞—Ç—É—Å
                    {% elif notification.notification_type == "PAYMENT_ADDED" %}
                        üí≥ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É
                    {% else %}
                        {{ notification.get_notification_type_display }}
                    {% endif %}
                </h6>
                <small>{{ notification.created_at|date:"d.m.Y H:i" }}</small>
            </div>
            <p class="mb-1">
                <a href="{% url 'srm_ui:lead_detail' notification.lead.id %}">
                    –õ–∏–¥: {{ notification.lead.name }} ({{ notification.lead.get_type_display }})
                </a>
            </p>
            {% if not notification.is_read %}
            <form method="post" action="{% url 'srm_ui:mark_notification_read' notification.id %}" class="d-inline">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm btn-outline-secondary">–ü–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ</button>
            </form>
            {% endif %}
        </div>
        {% endfor %}
    </div>
{% else %}
    <p class="text-muted">–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</p>
{% endif %}
{% endblock %}

